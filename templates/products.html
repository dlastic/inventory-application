{% extends "layout.html" %}

{% block content %}
  <section>
    {% if category %}
      <h2>Products in Category: {{ category.name }}</h2>
    {% else %}
      <h2>All Products</h2>
    {% endif %}
    <div class="card-container">
      {% for product in products %}
        <a class="card" href="{{ url_for('view_product', product_id=product.id) }}">
          <div>
            <h3>{{ product.name }}</h3>
            <p>Price: {{ product.price }} USD</p>
            <p>Stock: {{ product.stock }}</p>
          </div>
        </a>
      {% else %}
        <h3 class="card">No products in this category at the moment.</h3>
      {% endfor %}

      <div class="form__actions">
        {% if category and category.id != 1 %}
          <a class="btn btn--edit"
             href="{{ url_for('edit_category', category_id=category.id, cancel=url_for('view_category', category_id=category.id) ) }}">Edit Category</a>

          <form method="post"
                action="{{ url_for('delete_category', category_id=category.id, cancel=url_for('view_category', category_id=category.id) ) }}">
            <button class="btn btn--delete"
                    type="submit"
                    onclick="return confirm('Are you sure you want to delete this category?');">
              Delete Category
            </button>
          </form>
        {% endif %}
        <a class="btn btn--add" href="{{ url_for('add_product') }}">Add Product</a>
      </div>
    </div>
  </section>
{% endblock content %}
