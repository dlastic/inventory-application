{% extends "layout.html" %}

{% block content %}
  <section>
    {% if category %}
      <h2>Products in Category: {{ category.name }}</h2>
    {% else %}
      <h2>All Products</h2>
    {% endif %}

    <div class="row g-3 mt-3">
      {% for product in products %}
        <div class="col-sm-6 col-md-4">
          <a class="card h-100 text-decoration-none text-body"
             href="{{ url_for('products.view_product', product_id=product.id) }}">
            <div class="card-body">
              <h5 class="card-title">{{ product.name }}</h5>
              <p class="card-text mb-1">Price: {{ product.price }} USD</p>
              <p class="card-text">Stock: {{ product.stock }}</p>
            </div>
          </a>
        </div>
      {% else %}
        <div class="col-12">
          <div class="alert alert-secondary">No products in this category at the moment.</div>
        </div>
      {% endfor %}
    </div>

    <div class="mt-4 d-flex flex-wrap gap-2">
      {% if category and category.id != config['DEFAULT_CATEGORY_ID'] %}
        <a class="btn btn-warning" href="{{ url_for('categories.edit_category', category_id=category.id) }}">Edit Category</a>
        <form method="post"
              action="{{ url_for('categories.delete_category', category_id=category.id) }}"
              class="d-inline">
          <button class="btn btn-danger"
                  type="submit"
                  onclick="return confirm('Are you sure you want to delete this category?');">
            Delete Category
          </button>
        </form>
      {% endif %}
      <a class="btn btn-success"
         href="{{ url_for('products.add_product', category_id=category.id if category else None) }}">Add Product</a>
    </div>
  </section>
{% endblock content %}
